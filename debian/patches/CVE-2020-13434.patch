Description: CVE-2020-13434
 integer overflow in sqlite3_str_vappendf in printf.c

---
Author: Abhijith PA <abhijith@debian.org>
Origin: https://www.sqlite.org/src/info/d08d3405878d394e
Last-Update: 2020-05-25

--- sqlite3-3.8.7.1.orig/src/printf.c
+++ sqlite3-3.8.7.1/src/printf.c
@@ -180,6 +180,13 @@ static char *getTextArg(PrintfArguments
 #define etBUFSIZE SQLITE_PRINT_BUF_SIZE  /* Size of the output buffer */
 
 /*
+** Hard limit on the precision of floating-point conversions.
+*/
+#ifndef SQLITE_PRINTF_PRECISION_LIMIT
+# define SQLITE_FP_PRECISION_LIMIT 100000000
+#endif
+
+/*
 ** Render a string given by "fmt" into the StrAccum object.
 */
 void sqlite3VXPrintf(
@@ -453,6 +460,11 @@ void sqlite3VXPrintf(
         length = 0;
 #else
         if( precision<0 ) precision = 6;         /* Set default precision */
+        #ifdef SQLITE_FP_PRECISION_LIMIT
+        if( precision>SQLITE_FP_PRECISION_LIMIT ){
+          precision = SQLITE_FP_PRECISION_LIMIT;
+        }
+#endif
         if( realvalue<0.0 ){
           realvalue = -realvalue;
           prefix = '-';
