From: Markus Koschany <apo@debian.org>
Date: Thu, 10 Jan 2019 12:16:48 +0100
Subject: CVE-2017-2518

Origin: https://www.sqlite.org/src/info/0a98c8d76ac86412
---
 src/where.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/where.c b/src/where.c
index 793b01d..f30b033 100644
--- a/src/where.c
+++ b/src/where.c
@@ -1380,6 +1380,8 @@ static void exprAnalyze(
   /* Prevent ON clause terms of a LEFT JOIN from being used to drive
   ** an index for tables to the left of the join.
   */
+  testcase( pTerm!=&pWC->a[idxTerm] );
+  pTerm = &pWC->a[idxTerm];
   pTerm->prereqRight |= extraRight;
 }
 
